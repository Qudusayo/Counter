<!DOCTYPE html>
<html lang="en">
    <head>
       <meta charset="utf-8">
        <title>CounterApp</title>

	 	<script src="/socket.io/socket.io.js"></script>
	 	<link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-combined.min.css" rel="stylesheet">
	 	<link type="text/css" rel="stylesheet" href="css/custom.css">
	</head>
	<body>
		<div class="container">
			<center>
				<h1 id="compteur"></h1>
				<button id="incrBtn" class="btn btn-primary btn-large">1 click = 1 cookie!</button>
				<p id="timestamp">Last update: <span id="lastupdate">not updated yet</span></p>
			</center>
		</div>
		<script type="text/javascript">
			var incrBtn = document.getElementById("incrBtn")
			compteur    = document.getElementById("compteur")
			lastupdate  = document.getElementById("lastupdate")
			socket      = io.connect("http://localhost:25000")

			socket.on('updateval', function(data) {
				compteur.innerHTML = data.val
			});

			socket.on('updatetime', function(data) {
				lastupdate.innerHTML = new Date(data.timestamp).toUTCString()
			});

			incrBtn.addEventListener("click", function(event) {
				// To prevent 'cheating', of course you can remove it since the goal of node.js is to build scalable applications; so you can test to tigger the button with some magic code.
				if (event.screenX != 0 && event.screenY != 0) {
					compteur.innerHTML = parseInt(compteur.innerHTML)+1
					socket.emit('incr', null)
				} else { 
					console.log("Cheating is bad.")
				}
			});
		</script>
	</body>
</html>